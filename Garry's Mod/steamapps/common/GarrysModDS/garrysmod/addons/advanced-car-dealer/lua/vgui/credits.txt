Things here are taken from the KVS library.
Thanks Stim and Kotus for their work.